import{r as V}from"./button-61cdb66f.js";import{bW as D,b as N,d as R,a as M,e as T,aG as A,af as B,ax as K,r as F,i as L,a5 as x,bt as O,y as w,c as W}from"./index-0d98e2cf.js";import{s as j,e as H}from"./page-a6bf83c3.js";import{I,p as U,a3 as z,w as X,z as q}from"./wrapEmojiText-3e48fcf3.js";import{S as J}from"./scrollable-2e30a7aa.js";function G(f,e){const t=Array.isArray(e)?e:e.split(D);let s=f;for(const o of t)if(s=s?.[o],!s)break;return s}class ae{constructor(e={}){const t=this.label=document.createElement("label");t.classList.add("checkbox-field"),e.restriction&&!e.toggle&&t.classList.add("checkbox-field-restriction"),e.round&&t.classList.add("checkbox-field-round"),e.disabled&&this.toggleDisability(!0),this.listenerSetter=e.listenerSetter;const s=this.input=document.createElement("input");if(s.classList.add("checkbox-field-input"),s.type=e.asRadio?"radio":"checkbox",e.name&&(s[e.asRadio?"name":"id"]="input-"+e.name),e.checked&&(s.checked=!0),e.stateKey){let n=e.checked!==void 0;const r=()=>{if(!n)return;let i;e.stateValues?i=e.stateValues[s.checked?1:0]:(i=s.checked,e.stateValueReverse&&(i=!i)),M.managers.appStateManager.setByKey(e.stateKey,i)};!n&&N.getState().then(i=>{n=!0;const m=G(i,e.stateKey);let a;e.stateValues?a=e.stateValues.indexOf(m)===1:(a=m,e.stateValueReverse&&(a=!a)),this.setValueSilently(a)}),e.listenerSetter?e.listenerSetter.add(s)("change",r):s.addEventListener("change",r)}let o;if(e.text?(o=this.span=document.createElement("span"),o.classList.add("checkbox-caption"),R(o,e.text,e.textArgs)):t.classList.add("checkbox-without-caption"),t.append(s),e.toggle){t.classList.add("checkbox-field-toggle"),e.restriction&&t.classList.add("checkbox-field-toggle-restriction");const n=document.createElement("div");n.classList.add("checkbox-toggle");const r=document.createElement("div");r.classList.add("checkbox-toggle-circle"),n.append(r),t.append(n)}else{const n=document.createElement("div");n.classList.add("checkbox-box");const r=document.createElementNS("http://www.w3.org/2000/svg","svg");r.classList.add("checkbox-box-check"),r.setAttributeNS(null,"viewBox","0 0 24 24");const i=document.createElementNS("http://www.w3.org/2000/svg","use");i.setAttributeNS(null,"href","#check"),i.setAttributeNS(null,"x","-1"),r.append(i);const m=document.createElement("div");m.classList.add("checkbox-box-background");const a=document.createElement("div");a.classList.add("checkbox-box-border"),n.append(a,m,r),t.append(n)}o&&t.append(o),e.withRipple?(t.classList.add("checkbox-ripple","hover-effect"),V(t,void 0,void 0,!0)):e.withHover&&t.classList.add("hover-effect")}get checked(){return this.input.checked}set checked(e){this.setValueSilently(e),j(this.input,"change")}setValueSilently(e){this.input.checked=e}isDisabled(){return this.label.classList.contains("checkbox-disabled")}toggleDisability(e){return this.label.classList.toggle("checkbox-disabled",e),this.input.disabled=e,()=>this.toggleDisability(!e)}}const k=new Map;let S=0;const P=(f,e,t="")=>{t=e.country_code+t,S=Math.max(S,t.length),k.set(t,{country:f,code:e})};function Q(f){f=f||"",k.size||T.countriesList.forEach(c=>{c.country_codes.forEach(l=>{l.prefixes?l.prefixes.forEach(d=>{P(c,l,d)}):P(c,l)})});let e=f.replace(/\D/g,"");const t=e.slice(0,S);let s;for(let c=t.length-1;c>=0&&(s=k.get(t.slice(0,c+1)),!s);--c);if(!s)return{formatted:e,country:void 0,code:void 0,leftPattern:""};const o=s.country,n=s.code.patterns||[],r=e.slice(s.code.country_code.length);let i="",m=0,a="";for(let c=n.length-1;c>=0;--c){i=n[c];const l=i.replace(/ /g,"");let d=0;for(let h=0,p=Math.min(r.length,l.length);h<p;++h)if(r[h]===l[h])d+=1.01;else if(l[h]==="X")++d;else{d=0;break}d>m&&(m=d,a=i)}i=a||i,i=i.replace(/\d/g,"X"),i=s.code.country_code+" "+i,i.split("").forEach((c,l)=>{c===" "&&e[l]!==" "&&e.length>l&&(e=e.slice(0,l)+" "+e.slice(l))});let u=i&&i.length>e.length?i.slice(e.length):"";return u&&(u=u.replace(/X/g,"â€’")),{formatted:e,country:o,code:s.code,leftPattern:u}}class ne extends I{constructor(e={}){super({label:"Contacts.PhoneNumber.Placeholder",name:"phone",...e}),this.pasted=!1,this.lastValue="",this.container.classList.add("input-field-phone");const t=this.input;if(t instanceof HTMLInputElement)t.type="tel",t.autocomplete="rr55RandomRR55";else{t.inputMode="decimal";const s=window.devicePixelRatio;if(s>1){let n;B?n=s*-.16:K&&(n=0),t.style.setProperty("--letter-spacing",n+"px")}const o=this.setValueSilently.bind(this);this.setValueSilently=n=>{o(n),U(this.input,!0)}}t.addEventListener("input",()=>{t.classList.remove("error");const s=this.value;Math.abs(s.length-this.lastValue.length)>1&&!this.pasted&&A&&this.setValueSilently(this.lastValue+s),this.pasted=!1,this.setLabel();let n,r,i="";this.value.replace(/\++/,"+")==="+"?this.setValueSilently("+"):(n=Q(this.value),r=n.formatted,n.country,i=n.leftPattern,n.code,this.setValueSilently(this.lastValue=r?"+"+r:"")),t.dataset.leftPattern=i,e.onInput&&e.onInput(n)}),t.addEventListener("paste",()=>{this.pasted=!0}),t.addEventListener("keypress",s=>{const o=s.key;if(/\D/.test(o)&&!(s.metaKey||s.ctrlKey)&&o!=="Backspace"&&!(o==="+"&&s.shiftKey))return s.preventDefault(),!1})}}let b;const _=()=>{b=T.countriesList.filter(f=>!f.pFlags?.hidden).sort((f,e)=>(f.name||f.default_name).localeCompare(e.name||e.default_name))};let C=()=>{_(),M.addEventListener("language_change",()=>{_()})};const Y=new Set(["FT"]);class ie extends I{constructor(e={}){super({label:"Country",name:F(),...e}),this.options=e,this.hidePicker=()=>{this.hideTimeout===void 0&&(this.selectWrapper.classList.remove("active"),this.hideTimeout=window.setTimeout(()=>{this.selectWrapper.classList.add("hide"),this.hideTimeout=void 0},200))},this.selectCountryByTarget=a=>{const u=a.querySelector("[data-default-name]").dataset.defaultName,l=a.querySelector(".phone-code")?.innerText,d=l&&l.replace(/\D/g,"");this.value=L(u),this.lastCountrySelected=b.find(h=>h.default_name===u),this.lastCountryCodeSelected=d&&this.lastCountrySelected.country_codes.find(h=>h.country_code===d),this.options.onCountryChange?.(this.lastCountrySelected,this.lastCountryCodeSelected),this.hidePicker()},C&&(C(),C=void 0),this.liMap=new Map,this.container.classList.add("input-select");const t=this.selectWrapper=document.createElement("div");t.classList.add("select-wrapper","z-depth-3","hide");const s=document.createElement("span");s.classList.add("arrow","arrow-down"),this.container.append(s);const o=document.createElement("ul");t.appendChild(o),new J(t);let n=()=>{n=null,b.forEach(a=>{if(e.noPhoneCodes&&Y.has(a.iso2))return;const u=z(a.iso2),c=[];for(let l=0,d=Math.min(a.country_codes.length,e.noPhoneCodes?1:1/0);l<d;++l){const h=a.country_codes[l],p=document.createElement("li"),E=X(u);if(O){const g=document.createElement("span");w(g,E),p.append(g)}else w(p,E);const y=L(a.default_name);if(y.dataset.defaultName=a.default_name,p.append(y),!e.noPhoneCodes){const g=document.createElement("span");g.classList.add("phone-code"),g.innerText="+"+h.country_code,p.appendChild(g)}c.push(p),o.append(p)}this.liMap.set(a.iso2,c)}),o.addEventListener("mousedown",a=>{if(a.button!==0)return;const u=q(a.target,"LI");this.selectCountryByTarget(u)}),this.container.appendChild(t)};n(),this.input.addEventListener("focus",a=>{n?n():b.forEach(u=>{const c=this.liMap.get(u.iso2);c&&c.forEach(l=>l.style.display="")}),clearTimeout(this.hideTimeout),this.hideTimeout=void 0,t.classList.remove("hide"),t.offsetWidth,t.classList.add("active"),this.select(),H({container:x(this.container,"scrollable-y"),element:this.input,position:"start",margin:4}),setTimeout(()=>{r||(document.addEventListener("mousedown",i,{capture:!0}),r=!0)},0)});let r=!1;const i=a=>{x(a.target,"input-select")||a.target!==this.input&&(this.hidePicker(),document.removeEventListener("mousedown",i,{capture:!0}),r=!1)},m=a=>{const u=a.key;if(a.ctrlKey||u==="Control")return!1;const c=this.value.toLowerCase(),l=[];b.forEach(d=>{const h=this.liMap.get(d.iso2);if(!h)return;const p=[d.name,d.default_name,d.iso2];p.filter(Boolean).forEach(y=>{const g=y.split(" ").filter(v=>/\w/.test(v)).map(v=>v[0]).join("");g.length>1&&p.push(g)});const E=!!p.filter(Boolean).find(y=>y.toLowerCase().indexOf(c)!==-1);h.forEach(y=>y.style.display=E?"":"none"),E&&l.push(d)}),l.length===0?b.forEach(d=>{const h=this.liMap.get(d.iso2);h&&h.forEach(p=>p.style.display="")}):l.length===1&&u==="Enter"&&(W(a),this.selectCountryByTarget(this.liMap.get(l[0].iso2)[0]))};this.input.addEventListener("keyup",m),this.input.addEventListener("keydown",a=>{a.key==="Enter"&&m(a)}),s.addEventListener("mousedown",a=>{this.input.matches(":focus")?(this.hidePicker(),this.input.blur()):(a.cancelBubble=!0,a.preventDefault(),this.input.focus())})}getSelected(){return{country:this.lastCountrySelected,code:this.lastCountryCodeSelected}}selectCountryByIso2(e){this.selectCountryByTarget(this.liMap.get(e)[0])}override(e,t,s){this.setValueSilently(e?L(e.default_name):s),this.lastCountrySelected=e,this.lastCountryCodeSelected=t,this.options.onCountryChange?.(this.lastCountrySelected,this.lastCountryCodeSelected)}}export{ie as C,ne as T,ae as a,Q as f,G as g};
//# sourceMappingURL=countryInputField-11ec4eca.js.map
